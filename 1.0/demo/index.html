<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>AmapUtils的demo</title>
    <script src="http://g.tbcdn.cn/kissy/k/1.3.0/kissy-min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="http://g.tbcdn.cn/kissy/k/1.3.0/css/dpl/base-min.css">
    <style>
        #map-container {
            width: 400px;
            height: 300px;
        }
    </style>
</head>
<body>
<h2>AmapUtils的demo</h2>

<div class="demo" id="demo">
    <h3 class="demo-title">生成器</h3>

    <div class="demo-content">
        <form id="config-form">
            <fieldset id="config-basic">
                <legend>基本</legend>
                <p><label for="level">缩放级别</label><input name="level" type="number" id="level"/></p>

                <p><label for="center-x">中心坐标值经度</label><input name="center-x" type="number" id="center-x"/></p>

                <p><label for="center-y">中心坐标值纬度</label><input name="center-y" type="number" id="center-y"/></p>

                <p><label for="zooms-1">缩放级别范围</label><input name="zooms-1" type="number" id="zooms-1"
                                                             value="3"/>-<input name="zooms-2" type="number"
                                                                                id="zooms-2" value="18"/></p>
                <!-- 图层 START
                <p>
                    <label for="defaultLayer">默认显示的图层</label>
                    <select name="defaultLayer" id="defaultLayer">
                        <option value="" selected></option>
                    </select>
                </p>
                图层 END -->
                <p><label for="resizeEnable">是否监控地图容器尺寸变化</label><input type="checkbox" name="resizeEnable"
                                                                        id="resizeEnable" value="1"/>是</p>

                <p><label for="dragEnable">地图是否可通过鼠标拖拽平移</label><input type="checkbox" name="dragEnable" id="dragEnable"
                                                                       value="1" checked/>是</p>

                <p><label for="zoomEnable">地图是否可缩放</label><input type="checkbox" name="zoomEnable" id="zoomEnable"
                                                                 value="1" checked/>是</p>

                <p><label for="keyboardEnable">地图是否可通过方向键盘平移浏览</label><input type="checkbox" name="keyboardEnable"
                                                                             id="keyboardEnable" value="1" checked/>是
                </p>

                <p><label for="jogEnable">地图是否使用缓动效果</label><input type="checkbox" name="jogEnable" id="jogEnable"
                                                                   value="1" checked/>是</p>

                <p><label for="continuousZoomEnable">地图是否使用连续缩放效果</label><input type="checkbox"
                                                                                name="continuousZoomEnable"
                                                                                id="continuousZoomEnable" value="1"
                                                                                checked/>是</p>

                <p><label for="doubleClickZoom">地图是否可通过双击鼠标放大地图</label><input type="checkbox" name="doubleClickZoom"
                                                                              id="doubleClickZoom" value="1" checked/>是
                </p>

                <p><label for="scrollWheel">地图是否可通过鼠标滚轮缩放浏览</label><input type="checkbox" name="scrollWheel"
                                                                          id="scrollWheel" value="1" checked/>是</p>

                <p><label for="touchZoom">地图在移动终端上是否可通过多点触控缩放浏览地图</label><input type="checkbox" name="touchZoom"
                                                                                id="touchZoom" value="1" checked/>是</p>

                <p>
                    <label for="crs">地图显示的参考坐标系</label>
                    <select name="crs" id="crs">
                        <option value=""></option>
                    </select>
                </p>
                <p><label for="animateEnable">地图平移过程中是否使用动画</label><input type="checkbox" name="animateEnable"
                                                                          id="animateEnable" value="1" checked/>是</p>
            </fieldset>
            <fieldset id="config-toolbar">
                <legend>ToolBar</legend>
                <p>
                    <label for="use-toolbar">启用ToolBar</label>
                    <input type="checkbox" name="use-toolbar"
                           id="use-toolbar" value="1" checked/>是
                </p>

                <p><label for="toolbar-offset-x">相对于地图容器左上角的偏移量x</label><input name="toolbar-offset-x" type="number"
                                                                               id="toolbar-offset-x"/></p>

                <p><label for="toolbar-offset-y">相对于地图容器左上角的偏移量y</label><input name="toolbar-offset-y" type="number"
                                                                               id="toolbar-offset-y"/></p>

                <p><label for="ruler">标尺键盘是否可见</label><input type="checkbox" name="ruler"
                                                             id="ruler" value="1" checked/>是</p>

                <p><label for="direction">方向键盘是否可见</label><input type="checkbox" name="direction"
                                                                 id="direction" value="1" checked/>是</p>

                <p><label for="autoPosition">是否自动定位</label><input type="checkbox" name="autoPosition"
                                                                  id="autoPosition" value="0" checked/>否</p>
            </fieldset>
            <fieldset id="config-overview">
                <legend>OverView</legend>
                <p>
                    <label for="use-overview">启用OverView</label>
                    <input type="checkbox" name="use-overview"
                           id="use-overview" value="1" checked/>是
                </p>

                <p><label for="is-open">标尺键盘是否可见</label><input type="checkbox" name="isOpen"
                                                               id="is-open" value="1" checked/>否</p>

                <p><label for="visible">方向键盘是否可见</label><input type="checkbox" name="visible"
                                                               id="visible" value="1" checked/>是</p>
            </fieldset>
            <fieldset id="config-scale">
                <legend>Scale</legend>
                <p>
                    <label for="use-overview">启用Scale</label>
                    <input type="checkbox" name="use-scale"
                           id="use-scale" value="1" checked/>是
                </p>
            </fieldset>
            <fieldset id="config-maptype">
                <legend>MapType</legend>
                <p>
                    <label for="use-maptype">启用MapType</label>
                    <input type="checkbox" name="use-maptype"
                           id="use-maptype" value="1" checked/>是
                </p>

                <p><label for="defaultType">相对于地图容器左上角的偏移量x</label><input name="toolbar-offset-x" type="defaultType"
                                                                          id="defaultType"/></p>

                <p><label for="show-traffic">叠加实时交通图层</label><input type="checkbox" name="showTraffic"
                                                                    id="show-traffic" value="1" checked/>否</p>

                <p><label for="show-road">叠加路网图层</label><input type="checkbox" name="show-road"
                                                               id="show-road" value="1" checked/>否</p>
            </fieldset>
        </form>

    </div>

    <div class="btns">
        <button type="button" id="generate-btn">生成</button>
    </div>

    <div class="result">
        <div id="map-container"></div>
    </div>
</div>

<script>
    var S = KISSY;
    if (S.Config.debug) {
        var srcPath = "../../";
        S.config({
            packages: [
                {
                    name: "gallery/amapUtils",
                    path: srcPath,
                    charset: "utf-8",
                    ignorePackageNameInUri: true
                }
            ]
        });
    }

    S.use('node, gallery/amapUtils/1.0/mapWrapper', function (S, Node, MapWrapper) {
        var configNames = [
            'level',
            'center-x',
            'center-y',
            'zooms-1',
            'zooms-2',
            'resizeEnable',
            'dragEnable',
            'zoomEnable',
            'keyboardEnable',
            'jogEnable',
            'continuousZoomEnable',
            'doubleClickZoom',
            'scrollWheel',
            'touchZoom',
            'crs',
            'animateEnable'
        ];

        function getConfig (config) {
            var formDOMNode = Node.one('#config-form').getDOMNode();
            var config = {
                key: 'b1081aad26845f8c4ed7136809e8e16a'
            };

            S.each([
                'level',
                'resizeEnable',
                'dragEnable',
                'zoomEnable',
                'keyboardEnable',
                'jogEnable',
                'continuousZoomEnable',
                'doubleClickZoom',
                'scrollWheel',
                'touchZoom',
                'crs',
                'animateEnable'
            ], function (name, index) {
                var inputDOMNode = formDOMNode[name];
                if (S.inArray(inputDOMNode.type == 'text', ['text', 'select'])) {
                    config[name] = inputDOMNode.value;
                } else if (inputDOMNode.type == 'number') {
                    config[name] = inputDOMNode.value * 1;
                } else if (inputDOMNode.type == 'checkbox') {
                    if (inputDOMNode.value == '1') {
                        config[name] = true;
                    } else {
                        config[name] = false;

                    }
                }
            });

            config.center = [formDOMNode['center-x'].value * 1, formDOMNode['center-y'] * 1];
            config.zooms = [formDOMNode['zooms-1'].value * 1, formDOMNode['zooms-2'] * 1];

            return config;
        }

        var mapWrapper;

        Node.one('#generate-btn').on('click', function (ev) {
            if (mapWrapper) {
                mapWrapper.get('map').destroy();
            }
            mapWrapper = new MapWrapper('#map-container', getConfig());
            mapWrapper.render();
        });

    })
</script>
</body>
</html>
